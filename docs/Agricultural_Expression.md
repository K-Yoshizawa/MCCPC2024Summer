# Agricultural Expression

## 問題文

Alice は新しい電卓を発明しました。この電卓は次の $3$ 種類の演算を処理することができます。

- **連結算** : `x+y` という形式で表される演算で、 $x$ と $y$ をこの順に連結して返す。例えば `123+456` は `123456` を返す。また、 $3$ 項以上にも同様に定義され、例えば `1+23+456+7890` は `1234567890` を返す。
- **成長算** : `G(x)` という形式で表される演算で、 $x$ の各桁の数を $1$ 増やす。ただし、桁の数が $9$ である桁には何もしない。例えば `G(4096)` は `5197` を返す。
- **収穫算** : `H(x)` という形式で表される演算で、 $x$ の各桁の総和を返す。例えば `H(4096)` は `19` を返す。

Alice は試運転として、文字列 $S$ を電卓に入力しました。

文字列 $S$ は次の BNF 記法で表された文法 $E$ によって生成された `<expr>` です。

```
<expr> := <term> | <term> + '+' + <expr>
<term> := <grow> | <heavest> | <number>
<grow> := 'G(' + <expr> + ')'
<harvest> := 'H(' + <expr> + ')'
<number> := <digit> | <digit> <number>
<digit> := '0' | '1' | '2' | '3' | '4' | '5' | '6' | '7' | '8' | '9'
```

$S$ を計算した結果を求めてください。

## 制約

- $1 \le |S| \le 5 \times 10^5$
- $S$ は $E$ によって生成される `<expr>`

## 部分点

※**部分点の設定が他の問題と異なるため注意してください。**

この問題はいくつかのデータセットに分かれており、それぞれのデータセットには追加の制約が設定されています。

データセットのすべてのテストケースに正解すると、そのデータセットに割り当てられた得点を獲得することができます。

### データセット 1

- $S$ は単一の**連結算**である。すなわち、 `<number>+<number>` という形式で表される。以降、このような形式で表される**連結算**を**単純な連結算**と定義する。

### データセット 2

- $S$ は単一の**成長算**である。すなわち、 `G(<number>)` という形式で表される。以降、このような形式で表される**成長算**を**単純な成長算**と定義する。

### データセット 3

- $S$ は単一の**収穫算**である。すなわち、 `H(<number>)` という形式で表される。以降、このような形式で表される**収穫算**を**単純な収穫算**と定義する。

### データセット 4

- $S$ は $2$ つの**単純な成長算**または**単純な収穫算**の結果に対する**連結算**である。より厳密には、次の BNF 記法で表された文法 $E_4$ によって生成される `<expr>` である。( $E$ は $E_4$ を包含している。)

```
<expr> := <term> + '+' + <term>
<term> := <simple_grow> | <simple_heavest>
<simple_grow> := 'G(' + <number> + ')'
<simple_heavest> := 'H(' + <number> + ')'
<number> := <digit> | <digit> <number>
<digit> := '0' | '1' | '2' | '3' | '4' | '5' | '6' | '7' | '8' | '9'
```

### データセット 5

- $S$ は $2$ つ以上の**単純な成長算**または**単純な収穫算**の結果に対する**連結算**である。より厳密には、次の BNF 記法で表された文法 $E_5$ によって生成される `<expr>` である。( $E$ は $E_5$ を包含している。)

```
<expr> := <term> + '+' + <expr_ext>
<expr_ext> := <term> | <term> + '+' + <expr_ext>
<term> := <simple_grow> | <simple_heavest>
<simple_grow> := 'G(' + <number> + ')'
<simple_heavest> := 'H(' + <number> + ')'
<number> := <digit> | <digit> <number>
<digit> := '0' | '1' | '2' | '3' | '4' | '5' | '6' | '7' | '8' | '9'
```

### データセット 6

- $S$ は**単純な成長算**、**単純な収穫算**、**単純な連結算**のいずれかの結果に対する**成長算**または**収穫算**である。より厳密には、次の BNF 記法で表された文法 $E_6$ によって生成される `<expr>` である。( $E$ は $E_6$ を包含している。) 以降、このような形式で表される**成長算**および**収穫算**を**入れ子な成長算**および**入れ子な収穫算**と定義する。

```
<expr> := <term>
<term> := <nested_grow> | <nested_heavest>
<nested_grow> := 'G(' + <term_ext> + ')'
<nested_harvest> := 'H(' + <term_ext> + ')'
<term_ext> := <simple_grow> | <simple_heavest> | <simple_connect>
<simple_connect> := <number> + '+' + <number>
<simple_grow> := 'G(' + <number> + ')'
<simple_heavest> := 'H(' + <number> + ')'
<number> := <digit> | <digit> <number>
<digit> := '0' | '1' | '2' | '3' | '4' | '5' | '6' | '7' | '8' | '9'
```

### データセット 7

- $S$ は $2$ つ以上の**入れ子な成長算**または**入れ子な収穫算**の結果に対する**連結算**である。より厳密には、次の BNF 記法で表された文法 $E_7$ によって生成される `<expr>` である。( $E$ は $E_7$ を包含している。)

```
<expr> := <term> + '+' + <expr_ext>
<expr_ext> := <term> | <term> + '+' + <expr_ext>
<term> := <nested_grow> | <nested_heavest>
<nested_grow> := 'G(' + <term_ext> + ')'
<nested_harvest> := 'H(' + <term_ext> + ')'
<term_ext> := <simple_grow> | <simple_heavest> | <simple_connect>
<simple_connect> := <number> + '+' + <number>
<simple_grow> := 'G(' + <number> + ')'
<simple_heavest> := 'H(' + <number> + ')'
<number> := <digit> | <digit> <number>
<digit> := '0' | '1' | '2' | '3' | '4' | '5' | '6' | '7' | '8' | '9'
```

### データセット 8

- 追加の制約はない。

## 入力

入力は以下の形式で標準入力から与えられます。

<div class="code-math">

$S$

</div>

## 出力

答えを $1$ 行に出力してください。

## 入力例1
```
123+456
```

## 出力例1
```
123456
```

この入力例はデータセット 1, 8 に含まれます。

## 入力例2
```
G(4096)
```

## 出力例2
```
5197
```

この入力例はデータセット 2, 8 に含まれます。

## 入力例3
```
H(4096)
```

## 出力例3
```
19
```

この入力例はデータセット 3, 8 に含まれます。

## 入力例4
```
G(0000)+H(0000)
```

## 出力例4
```
11110
```

この入力例はデータセット 4, 5, 8 に含まれます。

## 入力例5
```
H(G(12345678901234567890))
```

## 出力例5
```
108
```

この入力例はデータセット 6, 8 に含まれます。

## 入力例6
```
G(H(57))+H(628+222)+H(H(00))
```

## 出力例6
```
23220
```

この入力例はデータセット 7, 8 に含まれます。

## 入力例7
```
G(998+H(244)+G(353))+H(3+G(H(14+G(15))+92)+65+G(3))
```

## 出力例7
```
9992157536
```

この入力例はデータセット 8 に含まれます。