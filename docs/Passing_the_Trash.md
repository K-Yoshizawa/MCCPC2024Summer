# Passing the Trash

## 問題文（概要）

MCC(Macro Computer Club) には $N + 1$ 人の部員が所属しており、各部員に部員番号 $0, 1, \dots, N$ が付けられています。部長であるとここちゃんの部員番号は $0$ です。

ある日、とここちゃんは MCC にお土産を買ってきました。お土産は $M$ 個のお菓子が入った箱です。とここちゃんは、初めに箱を部員番号 $1$ から部員番号 $N$ の部員の誰かに渡します。

ここで、部員番号 $i$ である部員は、箱を受け取ると次の行動を行うことが分かっています。

- 箱を受け取った時点で箱に入っているお菓子の個数を $x$ とする。
    - $x \gt P_i$ のとき、箱の中から $P_i$ 個のお菓子を取り、箱を部員番号 $Q_i$ の部員に渡す。
    - $x \le P_i$ のとき、箱の中のお菓子をすべて取る。

MCC には「最後にお菓子をすべて取った人が箱を持ち帰る」というルールがあります。とここちゃんはこのルールに則って、部員番号 $i$ の部員が箱の中のお菓子をすべて取ったとき、その部員に箱を持ち帰らせることにしました。

とここちゃんが最初に誰に箱を渡すかによって、箱を持ち帰ることになる部員が複数人いる可能性があります。箱を持ち帰ることになる可能性がある部員をすべて列挙してください。

## 制約

### Hard

- $2 \le N \le 2 \times 10^5$
- $1 \le M \le 10^{18}$
- $1 \le P_i \le M$
- $1 \le Q_i \le N$
- $Q_i \ne i$
- 入力はすべて整数

### Normal

- Hard の制約に以下の制約を追加
- $1 \le i \le N - 1 \Rightarrow Q_i = i + 1$
- $Q_N = 1$

### Easy

- Hard の制約に以下の制約を追加
- $2 \le N \le 1000$
- $1 \le M \le 1000$
- $1 \le i \le N - 1 \Rightarrow Q_i = i + 1$
- $Q_N = 1$

## 入力

入力は以下の形式で標準入力から与えられます。

<div class="code-math">

$N \ \ M$ \
$P_1 \ \ \dots \ \ P_N$ \
$Q_1 \ \ \dots \ \ Q_N$

</div>

## 出力

$1$ 行目に箱を持ち帰る可能性がある部員の人数を、$2$ 行目に箱を持ち帰らなければならない可能性がある部員の部員番号を**昇順**に空白区切りで出力してください。

より具体的には、部員 $S_1$、部員 $S_2$、$\dots$、部員 $S_K$ の $K$ 人 $(1 \le S_1 < \dots < S_K \le N)$ が箱を持ち帰る可能性があるとき、次の形式で出力してください。

<div class="code-math">

$K$ \
$S_1 \ \ \dots \ \ S_K$ 

</div>

## 想定解法

Functional Graph のダブリング＋$N$ 人に対して二分探索

$O(N \log M)$